parameters:
- name: Projects
  type: string
  default: ''
- name: NugetConfigPath
  type: string
  default: 'nuget.config'

steps:

# Install .NET SDK
- task: UseDotNet@2
  displayName: 'Install .NET 8 SDK'
  inputs:
    packageType: 'sdk'
    version: '8.0.x'
    performMultiLevelLookup: true

# Install NuGet manually (for Ubuntu 24.04)
- script: |
    curl -L https://dist.nuget.org/win-x86-commandline/latest/nuget.exe -o nuget.exe
    mkdir -p ~/.nuget
    mv nuget.exe ~/.nuget/
  displayName: 'Download NuGet CLI'

# Add NuGet path to PATH
- script: |
    echo '##vso[task.prependpath]$(HOME)/.nuget'
  displayName: 'Add NuGet CLI to PATH'

# Run NuGet restore
- task: NuGetCommand@2
  displayName: 'NuGet CLI - Restore'
  inputs:
    command: 'restore'
    projects: ${{ parameters.Projects }}
    feedsToUse: 'config'
    nugetConfigPath: ${{ parameters.NugetConfigPath }}
